# Chapter07 連続型確率変数

## 7.1 1次元の連続型確率変数

### 7.1.1 1次元の連続型確率変数の定義

#### 確率密度関数（probability density function, PDF）、密度関数

- 離散型確率変数
  - とりうる値の（離散的な）集合と確率関数によって定義できた。
  - $f(x) = P(X = x)$

- 連続型確率変数
  - とりうる値は、区間$[a, b$で定義され、
  - 確率は、確率密度関数（密度関数）$f(x)$によって定義される。
- 密度関数による確率は、
  - 確率変数$X$が$x_0 \leq X \leq x_1$の区間に入る確率$P(x_0 \leq X \leq x_1)$で定義され、
  - 積分で計算される。

$$
P(x_0 \leq X \leq x_1) = \int_{x_0}^{x_1} f(x)dx
$$

- この積分は密度関数$f(x)$と$x$軸、2直線 $x=x_0, x=x_1$ に囲まれた領域の面積と解釈できる。
- つまり領域の面積が、確率$P(x_0 \leq X \leq x_1)$になる。

#### 確率の性質

連続確率変数では、確率の性質として次の2つの式を満たす必要がある。

$$
\begin{align*}
f(x) &\geq 0
\\
\int_{-\infty}^{\infty} f(x)dx &= 1
\end{align*}
$$

#### 累積分布関数（cumulative distribution function, CDF）、分布関数

確率変数$X$が$x$以下になるときの確率を返す関数を$F(x)$と表す

$$
F(x) = P(X \leq x) = \int_{-\infty}^{x} f(x)dx
$$

#### 確率変数の変換

- ルーレットの出た値に2をかけて3を足した$2X+3$を使い、これを$Y$とすると、
- $x = (y - 3)/2$
- $Y$もまた連続型の確率変数になっている。


確率変数$Y$の密度関数を$g(y)$とすると、

$$
g(y) =
\begin{cases}
\begin{align*}
(y - 3)/2 ~~~ &(3 \leq y \leq 5)
\\
0 ~~~~~~~~~~~ &(otherwise)
\end{align*}
\end{cases}
$$

分布関数は、$G(y)$として、

$$
G(y) = P(Y \leq y) \int_{-\infty}^{y} g(y)dy
$$

### 7.1.2 1次元の連続型確率分布の指標

#### 期待値

- 連続型確率変数$X$の平均は次の式で定義される。
- これは、確率変数$X$の期待値とも呼ばれる。

$$
\mu = E(X) = \int_{-\infty}^{\infty} x f(x)dx
$$

変換した確率変数について期待値を定義できる。

- 確率変数$X$を$2X + 3$と変換した確率変数$Y$の期待値は次の式で定義される。

$$
E(Y) = E(2X + 3) = \int_{-\infty}^{\infty} (2x + 3)f(x)dx
$$

より一般的に、確率変数$X$の変換$g(X)$の期待値を定義できる。

#### 連続型確率変数の期待値（平均）

$$
E\big(~g(X)~\big) = \int_{-\infty}^{\infty} g(x)f(x)dx
$$

- $g$が確率変数に対する変換の関数になる。

#### 分散

- 連続型確率変数$X$の分散は、次の式で定義される。
- $\mu$は、確率変数$X$の期待値$E(X)$。

$$
\sigma^2 = V(X) = \int_{-\infty}^{\infty} (x - \mu)^2 f(x)dx
$$

変換した確率変数について分散を定義できる。

- 確率変数$X$を$2X + 3$と変換した確率変数$Y$の分散は次の式で定義される。
- $\mu = E(2X + 3)$

$$
V(Y) = V(2X + 3) = \int_{-\infty}^{\infty} ((2x + 3) - \mu)^2 f(x)dx
$$

より一般的に、確率変数$X$の変換$g(X)$の分散を定義できる。

#### 連続型確率変数の分散

$$
V\big(~g(X)~\big) = \int_{-\infty}^{\infty} \big( ~g(x) - E(g(X))~ \big)^2 f(x)dx
$$

- $g$が確率変数に対する変換の関数になる
- $E(g(X))$が期待値

- **期待値の線形性**
  - $E(aX + b) = aE(X) + b$
- **分散の公式**
  - $V(aX + b) = a^2V(X)$

## 7.2 2次元の連続確率変数

### 7.2.1 2次元の連続型確率分布の定義

#### 同時確率密度関数

2次元の連続型確率変数$(X, Y)$は、

とりうる組み合わせ

$$
\{(x, y) ~|~ a \leq x \leq b; ~ c \leq y \leq d\}
$$

と、それを定義域にする関数

$$
f(x, y)
$$

によって定義される。

- この関数$f(x, y)$のことを**同時確率密度関数**という。


$x_0 \leq X \leq x_1$かつ$y_0 \leq Y \leq y_1$となる確率は次のように定義される。

$$
P(x_0 \leq X \leq x_1, ~ y_0 \leq Y \leq y_1) =
\int_{x_0}^{x_1} \int_{y_0}^{y_1} f(x, y)dxdy
$$

2次元の連続型確率変数は確率の性質として、次の2つを満たす必要がある。

#### 確率の性質

$$
\begin{align*}
f(x, y) &\geq 0
\\
\int_{-\infty}^{\infty}\int_{-\infty}^{\infty} f(x, y) &= 1
\end{align*}
$$

#### 周辺確率密度関数

- 確率変数$(X, Y)$は、同時確率密度関数によって$X$と$Y$が同時に定義されていた。

- それぞれの確率変数にだけ興味がある場合、
  - 確率変数$X$の振る舞い（確率変数$X$の密度関数）を知りたい場合
  - 確率変数$Y$の振る舞い（確率変数$Y$の密度関数）を知りたい場合

このとき確率変数$X$の密度関数を$f_X(x)$とすると、

$$
f_X(x) = \int_{-\infty}^{\infty} f(x, y)dy
$$

が成り立つ。

このように求められた$f_X(x)$のことを、$X$の**周辺確率密度関数**、または**周辺密度関数**という。

## 7.2.2 2次元の連続型確率変数の指標

#### 期待値

- 1次元の連続型変数の期待値とほぼ同じ
- 確率変数$X$の期待値であれば、$x$と密度関数$f(x, y)$の積を$x$と$y$について積分することで求めることができる。

$$
\mu_X = E(X) = \int_{-\infty}^{\infty}\int_{-\infty}^{\infty} xf(x, y)dxdy
$$

一般に$X, Y$の関数$g(X, Y)$の期待値を定義でき、次のようになる。

$$
E\big( g(X, Y) \big) =
\int_{-\infty}^{\infty}\int_{-\infty}^{\infty} g(x, y)f(x, y)dxdy
$$

#### 分散

- 1次元のときとほぼ同じ
- 確率変数$X$の分散は次の式で求めることができる

$$
\sigma_X^2 = V(X) =
\int_{-\infty}^{\infty}\int_{-\infty}^{\infty} (x - \mu_X)^2 f(x, y)dxdy
$$

一般に$X, Y$の関数$g(X, Y)$の分散を定義でき、次のようになる。

$$
V\big( g(X, Y) \big) =
\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}
\big(~ g(x, y) - E(g(X, Y)) ~\big)^2 f(x, y)dxdy
$$

- $E( g(X, Y) )$: 期待値

#### 共分散

$$
\sigma_{XY} = Cov(X, Y) =
\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}
(x - \mu_X)(y - \mu_Y)f(x, y)dxdy
$$

#### 相関係数

$$
\rho_{XY} = \dfrac{\sigma_{XY}}{\sigma_X \sigma_Y}
$$
