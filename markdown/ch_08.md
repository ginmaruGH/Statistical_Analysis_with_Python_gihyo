# Chapter08 代表的な連続型確率分布

## 8.1 正規分布

- 正規分布（normal distribution）
  - ガウス分布（Gaussian distribution）
  - とりうる値は、実数全体
  - $N(\mu, \sigma^2)$
  - パラメータ
    - $\mu$（実数）
    - $\sigma^2$（$\sigma$は正の実数）

#### 正規分布の密度関数

$N(\mu, \sigma^2)$の密度関数

$$
f(x) = \dfrac{1}{\sqrt{2\pi}\sigma}exp\left\{ -\dfrac{(x - \mu)^2}{2\sigma^2} \right\}
~~~ (-\infty < x < \infty)
$$

#### 正規分布の期待値と分散

$X \sim N(\mu, \sigma^2)$とするとき

$$
\begin{align*}
E(X) &= \mu
\\
V(X) &= \sigma^2
\end{align*}
$$

#### 正規分布の変換

$N \sim N(\mu, \sigma^2)$とするとき、任意の実数$a, b$に対して

$$
aX + b \sim N(a\mu + b, ~ a^2\sigma^2)
$$

が成り立つ。

これを利用することで、

$X \sim N(\mu, \sigma^2)$を標準化した確率変数$Z = (X - \mu)/\sigma$は、$N(0, 1)$に従うことがわかる。

- **標準正規分布（standard normal distribution）**
  - 標準化した正規分布$N(0, 1)$

- **上側100α%点（upper 100α% point）**
  - $P(X \geq x) = \alpha$を満たすような$x$
  - 領域の面積が$\alpha$となるような左側の$x$座標に相当
- $z_\alpha$
  - $Z \sim N(0, 1)$とすると、$P(Z \geq z_\alpha) = \alpha$を満たす
- 標準正規分布は、$x=0$を中心に対称な形をしているので、$z_{1-\alpha} = -z_\alpha$が成り立つ

- **$100_\alpha\%$区間**
  - 確率が$\alpha$となる中央の区間
  - 領域の面積が$\alpha$となるような、$a, b$を求める
  - このときの左と右の余った部分の面積は等しくなる
  - $aとｂ$は$P(a \leq X \leq b) = \alpha$を満たし、
  - さらに$P(X \leq a) = P(X \geq b) = (1 - \alpha)/2$
  - このような区間$[a, b]$のこと

- 標準正規分布の場合、
  - $100(1 - \alpha)\%$区間を$z_\alpha$を使って、$[z_{1-\alpha/2}, z_{\alpha/2}]$で表すことができる
  - 標準正規分布の95%区間は$\alpha = 0.05$に対応することから、$[z_{0.975}, z_{0.025}]$と求めることができる

#### 正規分布のまとめ

|||
|:--:|:--:|
|パラメータ|$\mu, \sigma$|
|とりうる値|実数全体|
|密度関数|$\dfrac{1}{\sqrt{2\pi}\sigma}exp\left\{ -\dfrac{(x - \mu)^2}{2\sigma^2} \right\}$|
|期待値|$\mu$|
|分散|$\sigma^2$|
|scipy.stats|norm($\mu, \sigma$)|

## 8.2 指数分布

- 指数分布（exponential distribution）
  - ある事象が発生する間隔が従う分布
  - 取りうる値（0以上）
  - $E_x(\lambda)$
  - パラメータ
    - λ

#### 指数分布の密度関数

$Ex(\lambda)$の密度関数

$$
f(x) =
\begin{cases}
\begin{align*}
&\lambda e^{-\lambda x} ~~~ (x \geq 0)
\\
&0 ~~~~~~~~~ (otherwise)
\end{align*}
\end{cases}
$$

- $Ex(\lambda)$は、単位時間あたり平均$\lambda$回発生する事象の発生間隔が従う確率分布

#### 1日あたり平均2件の交通事故が発生する地域における1日の交通事故の発生間隔

- 交通事故を完全にランダムな事象と捉えると、
- 交通事故の発生間隔、（すなわち交通事故が起きてから次の事故が起きるまでの時間は）
  - $Ex(2)$に従うとみなすことができる。

このことから、この地域で交通事故が起きてから、3日以内にまた交通事故が起きる確率は、

$$
P(X \leq 3) = \int_{0}^{3} 2e^{-2x}dx \simeq 0.998
$$

と、求めることができる。

#### 1時間あたり平均10アクセスあるサイトへのアクセス間隔

- サイトへのアクセスを完全なランダムな事象と捉えると、
- アクセスの間隔は、$Ex(10)$に従う。

このことから、このサイトにアクセスがあってから1分以内にまたアクセスがある確率は、

$$
P(X \leq 1/60) = \int_{0}^{1/60} 10e^{-10x}dx \simeq 0.154
$$

と、求めることができる。

- 指数分布はポアソン分布との関わりが強い確率分布
- 単位時間あたり平均$\lambda$回発生するイベントに対して、
  - 単位時間あたりにイベントが発生する回数が従うのが、$Poi(\lambda)$
  - イベントの発生間隔が従うのが、$Ex(\lambda)$

#### 指数分布の期待値と分散

$X \sim Ex(\lambda)$とするとき、

$$
\begin{align*}
E(X) &= \dfrac{1}{\lambda}
\\
V(X) &= \dfrac{1}{\lambda^2}
\end{align*}
$$

#### 指数分布のまとめ

|||
|:--:|:--:|
|パラメータ|$\lambda$|
|とりうる値|正の実数|
|密度関数|$\lambda e^{-\lambda x}$|
|期待値|$1/\lambda$|
|分散|$1/\lambda^2$|
|scipy.stats|expon(scale=1/$\lambda$)|

## カイ二乗分布

- カイ二乗分布（chi-square distribution）
  - 分散の区間推定や独立性の検定で使われる確率分布
  - とりうる値（0以上の実数）

カイ二乗分布はお互いに独立な複数の標準正規分布によって、次のように定義される。

### カイ二乗分布 $\chi^2(n)$

$Z_1, Z_2, ..., Z_n$が互いに独立に$N(0, 1)$に従っているとき、その二乗和

$$
Y = \sum_{i=1}^{n} Z_{i}^2
$$

の確率分布を、「自由度nのカイ二乗分布」$\chi^2(n)$という。

#### カイ二乗分布の特徴

- 左右非対称で、右に歪んだ分布となっている
- 自由度が大きくなると、左右対称に近づく
- 自由度の値の近くに、分布のピークがある

#### カイ二乗分布のまとめ

|||
|:--:|:--:|
|パラメータ||
|とりうる値||
|scipy.stats|chi2($n$)|

## 8.4 t分布

- t分布（t distribution）
  - 正規分布の母平均の区間推定などに使われる確率分布
  - $t(n)$
  - とりうる値は、実数全体


互いに独立な標準正規分布とカイ二乗分布によって、次のように定義される。

### t分布 $t(n)$

- 確率変数$Z, Y$は互いに独立で、
- $Z$は標準正規分布$N(0, 1)$に、
- $Y$は自由度$n$のカイ二乗分布$\chi^2(n)$に
- それぞれ従うとき、

$$
t = \dfrac{Z}{\sqrt{Y/n}}
$$

の確率分布を自由度$n$のt分布という。

#### t分布の特徴

- 左右対称の分布になっている
- 標準正規分布よりも裾が厚い
- 自由度が大きくなると、標準正規分布に近づく
- 自由度$n$のt分布の上側$100_\alpha\%$点は、$t_\alpha(n)$と表記する

#### t分布のまとめ

|||
|:--:|:--:|
|パラメータ|$n$|
|とりうる値|実数全体|
|scipy.stats|t($n$)|

## 8.5 F分布

- F分布（F distribution）
  - 分散分析などで使われる確率分布
  - お互いに独立な2つのカイ二乗分布によって定義される

### F分布 $F(n_1, n_2)$

確率変数$Y_1, Y_2$はお互いに独立で、

それぞれ$Y_1 \sim \chi^2(n_1), Y_2 \sim \chi^2(n_2)$に従うとき、

$$
F = \dfrac{Y_1/n_1}{Y_2/n_2}
$$

の確率分布を自由度$n_1, n_2$のF分布 $F(n_1, n_2)$という。

#### F分布の特徴

- 左右非対称で、右に歪んだ分布
- 分布のピークは「1」近くにある

#### F分布のまとめ

|||
|:--:|:--:|
|パラメータ|$n_1, n_2$|
|とりうる値|非負の実数|
|scipy.stats|f($n_1, n_2$)|
